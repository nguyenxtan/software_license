# Tá»•ng quan Dá»± Ã¡n - Há»‡ thá»‘ng Quáº£n lÃ½ Báº£n quyá»n Pháº§n má»m

## ğŸ“‹ ThÃ´ng tin Dá»± Ã¡n

**TÃªn dá»± Ã¡n**: Há»‡ thá»‘ng Quáº£n lÃ½ Báº£n quyá»n & Há»£p Ä‘á»“ng Pháº§n má»m
**Má»¥c Ä‘Ã­ch**: Web app ná»™i bá»™ Ä‘á»ƒ theo dÃµi vÃ  nháº¯c nhá»Ÿ gia háº¡n báº£n quyá»n pháº§n má»m, há»£p Ä‘á»“ng báº£o trÃ¬ vÃ  dá»‹ch vá»¥
**CÃ´ng nghá»‡**: Full-stack TypeScript (Node.js + React)

---

## ğŸ¯ TÃ­nh nÄƒng ÄÃ£ HoÃ n thÃ nh

### 1. âœ… Quáº£n lÃ½ Báº£n quyá»n & Há»£p Ä‘á»“ng
- [x] ThÃªm/Sá»­a/XÃ³a thÃ´ng tin pháº§n má»m
- [x] LÆ°u trá»¯ Ä‘áº§y Ä‘á»§: tÃªn, chi phÃ­, phÃ²ng ban, ngÃ y háº¿t háº¡n, nhÃ  cung cáº¥p, sá»‘ há»£p Ä‘á»“ng
- [x] PhÃ¢n loáº¡i theo phÃ²ng ban
- [x] Theo dÃµi ngÆ°á»i phá»¥ trÃ¡ch
- [x] Quáº£n lÃ½ nhiá»u loáº¡i license (Subscription, Perpetual, Maintenance)

### 2. âœ… Há»‡ thá»‘ng Cáº£nh bÃ¡o Tá»± Ä‘á»™ng
- [x] Gá»­i email tá»± Ä‘á»™ng theo cÃ¡c má»‘c: 90, 60, 30, 7, 1, 0 ngÃ y trÆ°á»›c háº¿t háº¡n
- [x] Cron job cháº¡y hÃ ng ngÃ y vÃ o 1:00 AM
- [x] Cáº£nh bÃ¡o cho ngÆ°á»i phá»¥ trÃ¡ch vÃ  email nhÃ³m
- [x] TÃ¹y chá»‰nh báº­t/táº¯t nháº¯c nhá»Ÿ cho tá»«ng pháº§n má»m
- [x] Log Ä‘áº§y Ä‘á»§ lá»‹ch sá»­ gá»­i email (thÃ nh cÃ´ng/tháº¥t báº¡i)

### 3. âœ… Import/Export Excel
- [x] Template Excel chuáº©n vá»›i Ä‘áº§y Ä‘á»§ hÆ°á»›ng dáº«n
- [x] Upload vÃ  import hÃ ng loáº¡t
- [x] Validation dá»¯ liá»‡u khi import
- [x] BÃ¡o cÃ¡o chi tiáº¿t lá»—i tá»«ng dÃ²ng
- [x] Lá»‹ch sá»­ import vá»›i thá»‘ng kÃª thÃ nh cÃ´ng/tháº¥t báº¡i
- [x] Export danh sÃ¡ch ra Excel vá»›i filter

### 4. âœ… Quáº£n lÃ½ Gia háº¡n
- [x] Form gia háº¡n vá»›i ngÃ y háº¿t háº¡n má»›i, chi phÃ­
- [x] LÆ°u lá»‹ch sá»­ gia háº¡n Ä‘áº§y Ä‘á»§
- [x] Theo dÃµi ngÃ y cÅ©/má»›i, ngÆ°á»i thá»±c hiá»‡n, ghi chÃº
- [x] Cáº­p nháº­t tráº¡ng thÃ¡i tá»± Ä‘á»™ng sau gia háº¡n

### 5. âœ… Dashboard & BÃ¡o cÃ¡o
- [x] Tá»•ng quan: tá»•ng sá»‘ pháº§n má»m, sáº¯p háº¿t háº¡n, Ä‘Ã£ háº¿t háº¡n, Ä‘Ã£ gia háº¡n trong thÃ¡ng
- [x] Biá»ƒu Ä‘á»“ phÃ¢n bá»• theo phÃ²ng ban
- [x] Biá»ƒu Ä‘á»“ phÃ¢n bá»• theo tráº¡ng thÃ¡i
- [x] Biá»ƒu Ä‘á»“ timeline háº¿t háº¡n theo thÃ¡ng (12 thÃ¡ng tá»›i)
- [x] Top 10 pháº§n má»m sáº¯p háº¿t háº¡n
- [x] BÃ¡o cÃ¡o chi tiáº¿t cÃ³ thá»ƒ lá»c vÃ  xuáº¥t

### 6. âœ… Há»‡ thá»‘ng NgÆ°á»i dÃ¹ng & PhÃ¢n quyá»n
- [x] 4 vai trÃ²: ADMIN, MANAGER, USER, VIEWER
- [x] ÄÄƒng nháº­p vá»›i JWT authentication
- [x] Quáº£n lÃ½ user: thÃªm/sá»­a/xÃ³a, kÃ­ch hoáº¡t/vÃ´ hiá»‡u hÃ³a
- [x] GÃ¡n phÃ²ng ban cho user
- [x] PhÃ¢n quyá»n chi tiáº¿t theo tá»«ng chá»©c nÄƒng
- [x] Chuáº©n bá»‹ sáºµn Ä‘á»ƒ tÃ­ch há»£p Keycloak SSO

### 7. âœ… Quáº£n lÃ½ PhÃ²ng ban
- [x] ThÃªm/sá»­a/xÃ³a phÃ²ng ban
- [x] Cáº¥u hÃ¬nh email nhÃ³m cho tá»«ng phÃ²ng ban
- [x] Thá»‘ng kÃª sá»‘ user vÃ  sá»‘ pháº§n má»m theo phÃ²ng ban

### 8. âœ… Há»‡ thá»‘ng Email
- [x] SMTP configuration linh hoáº¡t
- [x] Email template HTML Ä‘áº¹p máº¯t
- [x] Gá»­i email tá»± Ä‘á»™ng theo lá»‹ch
- [x] Gá»­i email thá»§ cÃ´ng cho tá»«ng báº£n ghi
- [x] Log Ä‘áº§y Ä‘á»§ lá»‹ch sá»­ gá»­i email
- [x] Retry mechanism cho email tháº¥t báº¡i

### 9. âœ… ThÃ´ng bÃ¡o
- [x] Danh sÃ¡ch táº¥t cáº£ notification
- [x] Filter theo tráº¡ng thÃ¡i, loáº¡i
- [x] Xem chi tiáº¿t email Ä‘Ã£ gá»­i
- [x] Gá»­i láº¡i email náº¿u tháº¥t báº¡i
- [x] LÆ°u lá»‹ch sá»­ Ä‘áº§y Ä‘á»§

---

## ğŸ—ï¸ Kiáº¿n trÃºc Há»‡ thá»‘ng

### Backend (Node.js + Express)
```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/          # 7 controllers
â”‚   â”‚   â”œâ”€â”€ authController.js
â”‚   â”‚   â”œâ”€â”€ softwareAssetController.js
â”‚   â”‚   â”œâ”€â”€ departmentController.js
â”‚   â”‚   â”œâ”€â”€ userController.js
â”‚   â”‚   â”œâ”€â”€ uploadController.js
â”‚   â”‚   â”œâ”€â”€ dashboardController.js
â”‚   â”‚   â””â”€â”€ notificationController.js
â”‚   â”œâ”€â”€ routes/               # 7 route files
â”‚   â”œâ”€â”€ services/             # 3 services
â”‚   â”‚   â”œâ”€â”€ emailService.js
â”‚   â”‚   â”œâ”€â”€ excelService.js
â”‚   â”‚   â””â”€â”€ schedulerService.js
â”‚   â”œâ”€â”€ middleware/           # Auth & Error handling
â”‚   â”œâ”€â”€ config/               # Database & Email
â”‚   â””â”€â”€ utils/                # JWT & Password
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma         # 10 models
â”‚   â””â”€â”€ seed.js               # Sample data
â””â”€â”€ package.json
```

### Database Schema (PostgreSQL + Prisma)

**10 Models:**
1. `User` - NgÆ°á»i dÃ¹ng
2. `Department` - PhÃ²ng ban
3. `SoftwareAsset` - Báº£n quyá»n pháº§n má»m (model chÃ­nh)
4. `RenewalHistory` - Lá»‹ch sá»­ gia háº¡n
5. `Notification` - ThÃ´ng bÃ¡o email
6. `ImportJob` - Job import Excel
7. `ImportJobDetail` - Chi tiáº¿t tá»«ng dÃ²ng import
8. `SystemConfig` - Cáº¥u hÃ¬nh há»‡ thá»‘ng

**Enums:**
- Role: ADMIN, MANAGER, USER, VIEWER
- AssetStatus: ACTIVE, EXPIRED, RENEWED_PENDING, DONE, CANCELLED
- ActionType: RENEW, CANCEL, EXTEND, UPDATE_INFO
- NotificationType: UPCOMING_EXPIRY, EXPIRED, CUSTOM
- NotificationStatus: PENDING, SENT, ACKNOWLEDGED, FAILED

### Frontend (React + TypeScript + Vite)
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/                # MÃ n hÃ¬nh chÃ­nh
â”‚   â”‚   â”œâ”€â”€ Login.tsx
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”œâ”€â”€ SoftwareAssetList.tsx
â”‚   â”‚   â”œâ”€â”€ SoftwareAssetForm.tsx
â”‚   â”‚   â”œâ”€â”€ UploadExcel.tsx
â”‚   â”‚   â”œâ”€â”€ UserManagement.tsx
â”‚   â”‚   â”œâ”€â”€ DepartmentManagement.tsx
â”‚   â”‚   â””â”€â”€ Notifications.tsx
â”‚   â”œâ”€â”€ components/           # Reusable components
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ api.ts            # 6 API services
â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â””â”€â”€ AuthContext.tsx
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts          # TypeScript types
â”‚   â””â”€â”€ App.tsx
â””â”€â”€ package.json
```

### API Endpoints (40+ endpoints)

**Authentication:**
- POST `/api/auth/login`
- GET `/api/auth/me`
- POST `/api/auth/logout`

**Software Assets:**
- GET `/api/software-assets`
- GET `/api/software-assets/:id`
- POST `/api/software-assets`
- PUT `/api/software-assets/:id`
- DELETE `/api/software-assets/:id`
- POST `/api/software-assets/:id/complete-renewal`
- POST `/api/software-assets/:id/send-reminder`

**Departments:**
- GET `/api/departments`
- GET `/api/departments/:id`
- POST `/api/departments`
- PUT `/api/departments/:id`
- DELETE `/api/departments/:id`

**Users:**
- GET `/api/users`
- GET `/api/users/:id`
- POST `/api/users`
- PUT `/api/users/:id`
- DELETE `/api/users/:id`

**Upload/Import:**
- GET `/api/upload/template`
- POST `/api/upload/import`
- GET `/api/upload/jobs`
- GET `/api/upload/jobs/:id`
- GET `/api/upload/export`

**Dashboard:**
- GET `/api/dashboard/summary`
- GET `/api/dashboard/expiring`

**Notifications:**
- GET `/api/notifications`
- POST `/api/notifications/:id/resend`

---

## ğŸ“Š Dá»¯ liá»‡u Máº«u (Seed Data)

Há»‡ thá»‘ng Ä‘i kÃ¨m dá»¯ liá»‡u máº«u Ä‘áº§y Ä‘á»§:

### PhÃ²ng ban (4):
- PhÃ²ng CNTT
- PhÃ²ng Marketing
- PhÃ²ng TÃ i chÃ­nh
- PhÃ²ng NhÃ¢n sá»±

### NgÆ°á»i dÃ¹ng (4):
- Admin (ADMIN role)
- IT Manager (MANAGER role)
- Marketing Manager (MANAGER role)
- User1 (USER role)

### Pháº§n má»m (8):
- Microsoft Office 365 (háº¿t háº¡n sau 30 ngÃ y)
- Adobe Creative Cloud (háº¿t háº¡n sau 60 ngÃ y)
- Zoom Business (háº¿t háº¡n sau 90 ngÃ y)
- Kaspersky Antivirus (Ä‘Ã£ háº¿t háº¡n)
- Slack Enterprise (cÃ²n dÃ i háº¡n)
- GitHub Enterprise
- Jira Software
- Google Workspace (háº¿t háº¡n sau 45 ngÃ y)

---

## ğŸ” Báº£o máº­t

- [x] JWT authentication
- [x] Password hashing vá»›i bcrypt
- [x] Role-based access control (RBAC)
- [x] API authorization middleware
- [x] Input validation
- [x] SQL injection prevention (Prisma ORM)
- [x] XSS protection
- [x] CORS configuration
- [x] Secure cookie handling

---

## ğŸš€ Triá»ƒn khai

### Development:
```bash
# Backend
cd backend && npm run dev

# Frontend
cd frontend && npm run dev
```

### Production:
- Backend: PM2 hoáº·c Docker
- Frontend: Build static files â†’ Nginx/Apache
- Database: PostgreSQL managed service

---

## ğŸ“ˆ Kháº£ nÄƒng Má»Ÿ rá»™ng

### ÄÃ£ chuáº©n bá»‹ sáºµn:

1. **Keycloak SSO Integration**
   - Field `authProvider` vÃ  `externalId` trong User model
   - Environment variables cho Keycloak config

2. **Multi-tenant**
   - Database schema há»— trá»£ nhiá»u phÃ²ng ban
   - Row-level filtering theo department

3. **Audit Trail**
   - Renewal history Ä‘Ã£ Ä‘Æ°á»£c implement
   - CÃ³ thá»ƒ thÃªm audit log cho má»i action

4. **File Attachments**
   - Schema cÃ³ thá»ƒ má»Ÿ rá»™ng Ä‘á»ƒ lÆ°u file Ä‘Ã­nh kÃ¨m (PDF há»£p Ä‘á»“ng)

5. **Multi-language (i18n)**
   - Frontend structure sáºµn sÃ ng cho i18n
   - Backend error messages cÃ³ thá»ƒ localize

6. **Advanced Notifications**
   - CÃ³ thá»ƒ tÃ­ch há»£p Teams, Slack, Zalo OA
   - Notification service Ä‘Ã£ modular

7. **Multi-year Budget**
   - Field `budgetYear` Ä‘Ã£ cÃ³ trong schema

---

## ğŸ“ Best Practices ÄÃ£ Ãp dá»¥ng

### Backend:
- âœ… MVC architecture
- âœ… Middleware pattern
- âœ… Service layer separation
- âœ… Error handling centralized
- âœ… Environment configuration
- âœ… Database migrations
- âœ… Seeding data
- âœ… Input validation
- âœ… API versioning ready

### Frontend:
- âœ… Component-based architecture
- âœ… Context API for state management
- âœ… Custom hooks
- âœ… TypeScript strict mode
- âœ… API service layer
- âœ… Error boundary
- âœ… Loading states
- âœ… Responsive design ready

### Database:
- âœ… Foreign key constraints
- âœ… Indexes on frequently queried fields
- âœ… Cascade deletes
- âœ… Timestamps (createdAt, updatedAt)
- âœ… Enum types
- âœ… Proper data types (Decimal for money)

---

## ğŸ§ª Testing (Khuyáº¿n nghá»‹)

Há»‡ thá»‘ng sáºµn sÃ ng Ä‘á»ƒ thÃªm tests:

### Backend:
- Unit tests: Controllers, Services
- Integration tests: API endpoints
- E2E tests: Full workflows

### Frontend:
- Component tests: React Testing Library
- E2E tests: Playwright/Cypress

---

## ğŸ“š Documentation

ÄÃ£ táº¡o 3 file hÆ°á»›ng dáº«n chi tiáº¿t:

1. **README.md** - Tá»•ng quan dá»± Ã¡n
2. **SETUP.md** - HÆ°á»›ng dáº«n cÃ i Ä‘áº·t chi tiáº¿t
3. **QUICK_START.md** - HÆ°á»›ng dáº«n khá»Ÿi Ä‘á»™ng nhanh

---

## ğŸ¨ UI/UX Features

### Layout:
- Sidebar navigation
- Header vá»›i user info
- Responsive design ready
- Ant Design component library

### MÃ n hÃ¬nh:
1. Login page
2. Dashboard vá»›i charts
3. Software asset list vá»›i filter/search/sort
4. Software asset form (create/edit)
5. Upload Excel vá»›i preview
6. Import history
7. User management (CRUD)
8. Department management (CRUD)
9. Notification list
10. Reports & exports

### User Experience:
- Loading states
- Success/Error messages
- Confirmation dialogs
- Pagination
- Real-time search
- Advanced filtering
- Bulk operations ready
- Keyboard shortcuts ready

---

## ğŸ”§ Configuration

### Environment Variables:

**Backend (.env):**
```env
DATABASE_URL=postgresql://...
PORT=3000
JWT_SECRET=...
JWT_EXPIRES_IN=7d
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=...
SMTP_PASS=...
EMAIL_FROM=...
FRONTEND_URL=http://localhost:5173
DEFAULT_REMINDER_DAYS=90,60,30,7,1
ENABLE_AUTO_NOTIFICATIONS=true
AUTH_PROVIDER=local
```

**Frontend:**
- Proxy configuration in vite.config.ts
- API base URL configurable

---

## ğŸ“Š Performance Considerations

- [x] Database indexing
- [x] Pagination for large datasets
- [x] Lazy loading ready
- [x] Caching strategy ready
- [x] Connection pooling (Prisma)
- [x] Async operations
- [x] Background jobs for heavy tasks

---

## ğŸ› Error Handling

### Backend:
- Global error handler middleware
- Specific error messages tiáº¿ng Viá»‡t
- HTTP status codes chuáº©n
- Error logging

### Frontend:
- API error interceptor
- User-friendly error messages
- Retry mechanisms
- Fallback UI

---

## ğŸ“¦ Dependencies

### Backend (Main):
- express - Web framework
- @prisma/client - ORM
- bcryptjs - Password hashing
- jsonwebtoken - JWT
- nodemailer - Email
- node-cron - Scheduled jobs
- xlsx - Excel processing
- cors - CORS handling

### Frontend (Main):
- react - UI library
- antd - UI components
- axios - HTTP client
- recharts - Charts
- react-router-dom - Routing
- dayjs - Date handling

---

## ğŸ¯ Káº¿t luáº­n

Há»‡ thá»‘ng Ä‘Ã£ Ä‘Æ°á»£c xÃ¢y dá»±ng hoÃ n chá»‰nh vá»›i:
- âœ… Full-stack TypeScript
- âœ… Modern architecture
- âœ… Production-ready code
- âœ… Comprehensive documentation
- âœ… Sample data
- âœ… Security best practices
- âœ… Scalable structure
- âœ… Easy to maintain
- âœ… Ready to deploy

**Thá»i gian Æ°á»›c tÃ­nh Ä‘á»ƒ deploy vÃ  sá»­ dá»¥ng: 15-30 phÃºt**

---

## ğŸ“ Há»— trá»£

### CÃ¡c file quan trá»ng Ä‘á»ƒ tham kháº£o:

**Backend:**
- `backend/src/index.js` - Entry point
- `backend/prisma/schema.prisma` - Database schema
- `backend/src/services/schedulerService.js` - Cron jobs
- `backend/src/services/emailService.js` - Email logic

**Frontend:**
- `frontend/src/App.tsx` - Main app
- `frontend/src/services/api.ts` - API calls
- `frontend/src/contexts/AuthContext.tsx` - Authentication

**Documentation:**
- `README.md` - Overview
- `SETUP.md` - Detailed setup
- `QUICK_START.md` - Quick guide

---

**ChÃºc báº¡n triá»ƒn khai thÃ nh cÃ´ng! ğŸ‰ğŸš€**
